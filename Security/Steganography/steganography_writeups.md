# Райтапы на задачи по стеганографии

### Классное фото
Загружаем на stegonline. Крутим различные биты, обнаруживаем
флаг, вшитый по LSB

### Спектр звука
Как понятно из названия, просто загружаем в любое место, которое может
показать спектр, и из изображения спектра забираем флаг

### Наименее значимый мем
Тоже LSB, но чуть сложнее. Для решения достаточно закинуть файл
в тот же stegonline и обнаружить, что на нулевых битах творится что-то
странное.
Тыкаем extract files/data, выбираем R-0,G-0,B-0, получаем флаг

### Снежный день
Противная таска в том смысле, что надо знать про stegsnow, а так она проще
простого. `stegsnow -C snowy_day.txt` - и флаг наш

### Битое изображение
В файле повредждена сигнатура png - первые два байта `8950` заменены на `0000` (это всё hex)
Восстанавливаем изображение при помощи 010editor или hexedit, открываем изображение, получаем флаг

### Зачарованный лес
Ещё более сложное задание на LSB
Опять же, во всех каналах нулевой бит имеет имеет какие-то данные внизу
изображения
На сей раз просто изъять данные мало, их надо ещё и скачать. Качаем,
обнаруживаем
1) Кучу повторяющихся строк
2) base64
3) Хексовые нули в конце

base64 раскодируем в текстовый файл:
`echo 'base64_string' | base64 -d > forest.txt`
Там флаг (но на слова duckerz там нет)

### Ответ ИИ
Для решения таска надо знать, что .docx - это тоже зипники.
Расархивируем docx, везде проходися при помощи strings, находим
флаг

### Ошибочное мнение
Тут стеганография сделана посредством ошибок. Для решения надо было заметить, что каждое место ошибки - это буква во флаге. Например, первое слово в файле - Goot. Но на самом деле из контекста понятно, что имелось ввиду  слово Good. Значит, d - часть флага. Идём дальше по файлу и получаем флаг

### Пространство
Нужно было заметить, что два пробела - это по смыслу 1, а один - 0.
Прилагаю раскодировщик:

```python
data = ''
with open('area.txt', 'r') as file:
    data = file.read() 

results = ''
was_prev = False
i = 0
for c in data:
    if c != ' ':
        if was_prev:
            results += '0'
            was_prev = False
            i += 1
            if i % 8 == 0 and i != 0:
                results += ' '
    elif c == ' ':
        if was_prev:
            results += '1'
            was_prev = False
            i += 1
            if i % 8 == 0 and i != 0:
                results += ' '
        else:
            was_prev = True
    # print(c, results)
    # sleep(0.05)

print(results)
print(''.join(map(lambda c: chr(int(c, 2)), results.split())))
```

### Прятки
Решается так:
`steghide --extract -sf hide_n_seek.jpg`
Получаем флаг
Можно было пройтись по файлу при помощи strings и как раз обнаружить
эти странные строки, которые порождает steghide.
Пароль: отсутствует

### Нулевая ширина
Самая сложная из простых
Открываем файл, а там невидимые символы. Притом важно отметить,
что они всегда идут последовательностями по 8
Тут для решения надо было заметить такое:
1) Первые 4 символа везде одинаковы и ничего не значат
2) Следующие 4 - это 4 символа в четверичной системе счисления.

Для того, чтобы для этого додуматься, я брал коды в слове DUCKERZ
и пытался их как-то сопоставить с тем, что лежало в файле.
Прилагаю "декодер":

```python
with open('zero_width.txt') as f:
    data = f.read()

steganned = [[]]

k = 0

for c in data:
    if c in [chr(0x200c), chr(0x200d), chr(0x202c), chr(0xfeff)]:
        k += 1
        steganned[-1].append(c)
        if k % 8 == 0:
            steganned.append([])
if k % 8 == 0:
    steganned.pop(-1)

flag = 'DUCKERZ{'.ljust(len(steganned) - 1, '?') + '}'
print(len(steganned), len(flag))
for i in range(len(steganned)):
    print(steganned[i], flag[i])

char_to_int = {chr(0x200c): 0, chr(0x200d): 1, chr(0x202c): 2, chr(0xfeff): 3}

for code in steganned:
    needed_part = code[4:]
    sym_ord = 0
    power = 0
    for c in needed_part[::-1]:
        sym_ord += 4 ** power * char_to_int[c]
        power += 1
    
    print(chr(sym_ord), end='')

```

### Музыкальная картинка.
> На море на океане есть остров, на том острове дуб стоит, под дубом сундук зарыт, в сундуке — заяц, в зайце — утка, в утке — яйцо, в яйце — игла, — смерть Кощея

Ну короч, тут опять steghide. Из картинки командой
`steghide --extract -sf` извлекаем вавник, его пихаем в анализатор спектра,
и всё, флаг готов. По сути "средняя" таска составлена из 2 простых

# Мысли по тем таскам, которые я не решил
### Общая картина
Во-первых, формат bmp, что тут впервые на платформе встречается
LSB нет
Однако обнаружил кое-что странное: strings не ловит последовательности
символов длиннее 3 *вообще* (ну ладно, в начале файла есть 4 символа, но это единственный случай).
Я пытался как-то собирать данные из этой картинки в решение, не удалось

### Странный мем
Нам дан base64. Кодируем его в output.png, получаем картинку. Она частично битая (последний чанк не виден). Гипотетически, можно попытаться восстановить картинку руками и закинуть в steonline

### Фотокарточки
Много раз отправлял одно и то же изображение с одним и тем же текстом, заметил, что картинки немного различаются (можно воспользоваться библиотекой PIL и ксорнуть два изображения, чтобы в этом убедиться)
